/**
 * Copyright (c) 2021 Artem Hlumov <artyom.altair@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

#include <string>
#include <chrono>
#include <iomanip>
#include <iostream>

#include "fft.h"

/**
 * Input data for a test of size 2.
 */
std::complex<double> test_input_1[] = {{0, 2}, {1, 1}};
/**
 * Input data for a test of size 4.
 */
std::complex<double> test_input_2[] = {{0, 4}, {1, 3}, {2, 2}, {3, 1}};
/**
 * Input data for a test of size 8.
 */
std::complex<double> test_input_3[] = {{0, 8}, {1, 7}, {2, 6}, {3, 5}, {4, 4}, {5, 3}, {6, 2}, {7, 1}};
/**
 * Input data for a test of size 16.
 */
std::complex<double> test_input_4[] = {{0, 16}, {1, 15}, {2, 14}, {3, 13}, {4, 12}, {5, 11}, {6, 10}, {7, 9}, {8, 8}, {9, 7}, {10, 6}, {11, 5}, {12, 4}, {13, 3}, {14, 2}, {15, 1}};
/**
 * Input data for a test of size 32.
 */
std::complex<double> test_input_5[] = {{0, 32}, {1, 31}, {2, 30}, {3, 29}, {4, 28}, {5, 27}, {6, 26}, {7, 25}, {8, 24}, {9, 23}, {10, 22}, {11, 21}, {12, 20}, {13, 19}, {14, 18}, {15, 17}, {16, 16}, {17, 15}, {18, 14}, {19, 13}, {20, 12}, {21, 11}, {22, 10}, {23, 9}, {24, 8}, {25, 7}, {26, 6}, {27, 5}, {28, 4}, {29, 3}, {30, 2}, {31, 1}};
/**
 * Input data for a test of size 64.
 */
std::complex<double> test_input_6[] = {{0, 64}, {1, 63}, {2, 62}, {3, 61}, {4, 60}, {5, 59}, {6, 58}, {7, 57}, {8, 56}, {9, 55}, {10, 54}, {11, 53}, {12, 52}, {13, 51}, {14, 50}, {15, 49}, {16, 48}, {17, 47}, {18, 46}, {19, 45}, {20, 44}, {21, 43}, {22, 42}, {23, 41}, {24, 40}, {25, 39}, {26, 38}, {27, 37}, {28, 36}, {29, 35}, {30, 34}, {31, 33}, {32, 32}, {33, 31}, {34, 30}, {35, 29}, {36, 28}, {37, 27}, {38, 26}, {39, 25}, {40, 24}, {41, 23}, {42, 22}, {43, 21}, {44, 20}, {45, 19}, {46, 18}, {47, 17}, {48, 16}, {49, 15}, {50, 14}, {51, 13}, {52, 12}, {53, 11}, {54, 10}, {55, 9}, {56, 8}, {57, 7}, {58, 6}, {59, 5}, {60, 4}, {61, 3}, {62, 2}, {63, 1}};
/**
 * Input data for a test of size 128.
 */
std::complex<double> test_input_7[] = {{0, 128}, {1, 127}, {2, 126}, {3, 125}, {4, 124}, {5, 123}, {6, 122}, {7, 121}, {8, 120}, {9, 119}, {10, 118}, {11, 117}, {12, 116}, {13, 115}, {14, 114}, {15, 113}, {16, 112}, {17, 111}, {18, 110}, {19, 109}, {20, 108}, {21, 107}, {22, 106}, {23, 105}, {24, 104}, {25, 103}, {26, 102}, {27, 101}, {28, 100}, {29, 99}, {30, 98}, {31, 97}, {32, 96}, {33, 95}, {34, 94}, {35, 93}, {36, 92}, {37, 91}, {38, 90}, {39, 89}, {40, 88}, {41, 87}, {42, 86}, {43, 85}, {44, 84}, {45, 83}, {46, 82}, {47, 81}, {48, 80}, {49, 79}, {50, 78}, {51, 77}, {52, 76}, {53, 75}, {54, 74}, {55, 73}, {56, 72}, {57, 71}, {58, 70}, {59, 69}, {60, 68}, {61, 67}, {62, 66}, {63, 65}, {64, 64}, {65, 63}, {66, 62}, {67, 61}, {68, 60}, {69, 59}, {70, 58}, {71, 57}, {72, 56}, {73, 55}, {74, 54}, {75, 53}, {76, 52}, {77, 51}, {78, 50}, {79, 49}, {80, 48}, {81, 47}, {82, 46}, {83, 45}, {84, 44}, {85, 43}, {86, 42}, {87, 41}, {88, 40}, {89, 39}, {90, 38}, {91, 37}, {92, 36}, {93, 35}, {94, 34}, {95, 33}, {96, 32}, {97, 31}, {98, 30}, {99, 29}, {100, 28}, {101, 27}, {102, 26}, {103, 25}, {104, 24}, {105, 23}, {106, 22}, {107, 21}, {108, 20}, {109, 19}, {110, 18}, {111, 17}, {112, 16}, {113, 15}, {114, 14}, {115, 13}, {116, 12}, {117, 11}, {118, 10}, {119, 9}, {120, 8}, {121, 7}, {122, 6}, {123, 5}, {124, 4}, {125, 3}, {126, 2}, {127, 1}};
/**
 * Input data for a test of size 256.
 */
std::complex<double> test_input_8[] = {{0, 256}, {1, 255}, {2, 254}, {3, 253}, {4, 252}, {5, 251}, {6, 250}, {7, 249}, {8, 248}, {9, 247}, {10, 246}, {11, 245}, {12, 244}, {13, 243}, {14, 242}, {15, 241}, {16, 240}, {17, 239}, {18, 238}, {19, 237}, {20, 236}, {21, 235}, {22, 234}, {23, 233}, {24, 232}, {25, 231}, {26, 230}, {27, 229}, {28, 228}, {29, 227}, {30, 226}, {31, 225}, {32, 224}, {33, 223}, {34, 222}, {35, 221}, {36, 220}, {37, 219}, {38, 218}, {39, 217}, {40, 216}, {41, 215}, {42, 214}, {43, 213}, {44, 212}, {45, 211}, {46, 210}, {47, 209}, {48, 208}, {49, 207}, {50, 206}, {51, 205}, {52, 204}, {53, 203}, {54, 202}, {55, 201}, {56, 200}, {57, 199}, {58, 198}, {59, 197}, {60, 196}, {61, 195}, {62, 194}, {63, 193}, {64, 192}, {65, 191}, {66, 190}, {67, 189}, {68, 188}, {69, 187}, {70, 186}, {71, 185}, {72, 184}, {73, 183}, {74, 182}, {75, 181}, {76, 180}, {77, 179}, {78, 178}, {79, 177}, {80, 176}, {81, 175}, {82, 174}, {83, 173}, {84, 172}, {85, 171}, {86, 170}, {87, 169}, {88, 168}, {89, 167}, {90, 166}, {91, 165}, {92, 164}, {93, 163}, {94, 162}, {95, 161}, {96, 160}, {97, 159}, {98, 158}, {99, 157}, {100, 156}, {101, 155}, {102, 154}, {103, 153}, {104, 152}, {105, 151}, {106, 150}, {107, 149}, {108, 148}, {109, 147}, {110, 146}, {111, 145}, {112, 144}, {113, 143}, {114, 142}, {115, 141}, {116, 140}, {117, 139}, {118, 138}, {119, 137}, {120, 136}, {121, 135}, {122, 134}, {123, 133}, {124, 132}, {125, 131}, {126, 130}, {127, 129}, {128, 128}, {129, 127}, {130, 126}, {131, 125}, {132, 124}, {133, 123}, {134, 122}, {135, 121}, {136, 120}, {137, 119}, {138, 118}, {139, 117}, {140, 116}, {141, 115}, {142, 114}, {143, 113}, {144, 112}, {145, 111}, {146, 110}, {147, 109}, {148, 108}, {149, 107}, {150, 106}, {151, 105}, {152, 104}, {153, 103}, {154, 102}, {155, 101}, {156, 100}, {157, 99}, {158, 98}, {159, 97}, {160, 96}, {161, 95}, {162, 94}, {163, 93}, {164, 92}, {165, 91}, {166, 90}, {167, 89}, {168, 88}, {169, 87}, {170, 86}, {171, 85}, {172, 84}, {173, 83}, {174, 82}, {175, 81}, {176, 80}, {177, 79}, {178, 78}, {179, 77}, {180, 76}, {181, 75}, {182, 74}, {183, 73}, {184, 72}, {185, 71}, {186, 70}, {187, 69}, {188, 68}, {189, 67}, {190, 66}, {191, 65}, {192, 64}, {193, 63}, {194, 62}, {195, 61}, {196, 60}, {197, 59}, {198, 58}, {199, 57}, {200, 56}, {201, 55}, {202, 54}, {203, 53}, {204, 52}, {205, 51}, {206, 50}, {207, 49}, {208, 48}, {209, 47}, {210, 46}, {211, 45}, {212, 44}, {213, 43}, {214, 42}, {215, 41}, {216, 40}, {217, 39}, {218, 38}, {219, 37}, {220, 36}, {221, 35}, {222, 34}, {223, 33}, {224, 32}, {225, 31}, {226, 30}, {227, 29}, {228, 28}, {229, 27}, {230, 26}, {231, 25}, {232, 24}, {233, 23}, {234, 22}, {235, 21}, {236, 20}, {237, 19}, {238, 18}, {239, 17}, {240, 16}, {241, 15}, {242, 14}, {243, 13}, {244, 12}, {245, 11}, {246, 10}, {247, 9}, {248, 8}, {249, 7}, {250, 6}, {251, 5}, {252, 4}, {253, 3}, {254, 2}, {255, 1}};

/**
 * Output data for a test of size 2.
 */
std::complex<double> test_output_1[] = {{0.707106781186547, 2.12132034355964}, {-0.707106781186547, 0.707106781186547}};
/**
 * Output data for a test of size 4.
 */
std::complex<double> test_output_2[] = {{3, 5}, {-2, 0}, {-1, 1}, {0, 2}};
/**
 * Output data for a test of size 8.
 */
std::complex<double> test_output_3[] = {{9.89949493661166, 12.7279220613579}, {-4.82842712474619, -2}, {-2.82842712474619, 1.57009245868377e-16}, {-2, 0.828427124746191}, {-1.41421356237309, 1.41421356237309}, {-0.828427124746189, 2}, {0, 2.82842712474619}, {2, 4.82842712474619}};
/**
 * Output data for a test of size 16.
 */
std::complex<double> test_output_4[] = {{30, 34}, {-12.0546789842517, -8.05467898425169}, {-6.82842712474619, -2.82842712474619}, {-4.99321152533098, -0.993211525330977}, {-4, 2.22044604925031e-16}, {-3.3363572758386, 0.663642724161402}, {-2.82842712474619, 1.17157287525381}, {-2.39782473475932, 1.60217526524068}, {-2, 2}, {-1.60217526524068, 2.39782473475932}, {-1.17157287525381, 2.82842712474619}, {-0.663642724161401, 3.3363572758386}, {0, 4}, {0.993211525330979, 4.99321152533097}, {2.82842712474619, 6.82842712474619}, {8.0546789842517, 12.0546789842517}};
/**
 * Output data for a test of size 32.
 */
std::complex<double> test_output_5[] = {{87.6812408671319, 93.3380951166243}, {-31.5459296512289, -25.8890754017365}, {-17.0478905095827, -11.3910362600903}, {-12.1525017812121, -6.49564753171967}, {-9.65685424949238, -4}, {-8.12004208748212, -2.46318783798974}, {-7.06146745892073, -1.40461320942834}, {-6.27487554811809, -0.618021298625706}, {-5.65685424949238, 3.14018491736755e-16}, {-5.14965727742988, 0.50719697206251}, {-4.71832170841309, 0.938532541079281}, {-4.34025292014831, 1.31660132934408}, {-4, 1.65685424949238}, {-3.68642111286299, 1.97043313662938}, {-3.3910362600903, 2.26581798940209}, {-3.10700288155592, 2.54985136793649}, {-2.82842712474619, 2.82842712474619}, {-2.54985136793647, 3.1070028815559}, {-2.26581798940208, 3.3910362600903}, {-1.97043313662938, 3.686421112863}, {-1.65685424949238, 4}, {-1.31660132934407, 4.3402529201483}, {-0.93853254107928, 4.7183217084131}, {-0.507196972062505, 5.14965727742988}, {0, 5.65685424949238}, {0.618021298625711, 6.27487554811809}, {1.40461320942834, 7.06146745892071}, {2.46318783798975, 8.12004208748213}, {4, 9.65685424949238}, {6.49564753171967, 12.152501781212}, {11.3910362600903, 17.0478905095827}, {25.8890754017365, 31.5459296512288}};
/**
 * Output data for a test of size 64.
 */
std::complex<double> test_output_6[] = {{252, 260}, {-85.4218704999488, -77.4218704999487}, {-44.6126815504355, -36.6126815504354}, {-30.96580962166, -22.96580962166}, {-24.1093579685034, -16.1093579685034}, {-19.9688951350803, -11.9688951350803}, {-17.1862328357533, -9.18623283575328}, {-15.1792510899619, -7.17925108996191}, {-13.6568542494924, -5.65685424949238}, {-12.4572894301946, -4.45728943019455}, {-11.4834736471575, -3.48347364715755}, {-10.673596822334, -2.67359682233402}, {-9.98642305066197, -1.98642305066195}, {-9.39337565394687, -1.39337565394687}, {-8.87401410235191, -0.874014102351906}, {-8.41331990293394, -0.413319902933882}, {-8, 4.44089209850063e-16}, {-7.62538867607658, 0.374611323923394}, {-7.28271516331464, 0.717284836685369}, {-6.96660218508815, 1.03339781491186}, {-6.67271455167719, 1.3272854483228}, {-6.39750773472769, 1.6024922652723}, {-6.13804454380317, 1.86195545619684}, {-5.89185910356528, 2.10814089643472}, {-5.65685424949238, 2.34314575050762}, {-5.43122288525809, 2.56877711474191}, {-5.21338673442936, 2.78661326557063}, {-5.00194784076523, 2.99805215923478}, {-4.79564946951864, 3.20435053048137}, {-4.59334395015338, 3.4066560498466}, {-4.39396561342867, 3.60603438657137}, {-4.19650739907787, 3.80349260092213}, {-4, 4}, {-3.80349260092213, 4.19650739907787}, {-3.60603438657135, 4.39396561342864}, {-3.4066560498466, 4.59334395015339}, {-3.20435053048137, 4.79564946951864}, {-2.99805215923477, 5.00194784076522}, {-2.78661326557063, 5.21338673442937}, {-2.5687771147419, 5.43122288525809}, {-2.34314575050762, 5.65685424949238}, {-2.10814089643472, 5.89185910356529}, {-1.86195545619683, 6.13804454380316}, {-1.6024922652723, 6.3975077347277}, {-1.3272854483228, 6.6727145516772}, {-1.03339781491185, 6.96660218508814}, {-0.717284836685363, 7.28271516331464}, {-0.374611323923391, 7.62538867607662}, {0, 8}, {0.413319902933885, 8.4133199029339}, {0.874014102351913, 8.87401410235191}, {1.39337565394688, 9.39337565394688}, {1.98642305066196, 9.98642305066195}, {2.67359682233402, 10.673596822334}, {3.48347364715757, 11.4834736471576}, {4.45728943019456, 12.4572894301946}, {5.65685424949238, 13.6568542494924}, {7.17925108996192, 15.1792510899619}, {9.18623283575328, 17.1862328357533}, {11.9688951350804, 19.9688951350803}, {16.1093579685034, 24.1093579685034}, {22.9658096216599, 30.9658096216599}, {36.6126815504355, 44.6126815504354}, {77.4218704999488, 85.4218704999487}};
/**
 * Output data for a test of size 128.
 */
std::complex<double> test_output_7[] = {{718.420489685532, 729.734198184517}, {-236.091549296415, -224.77784079743}, {-120.804767784306, -109.491059285321}, {-82.3449562620564, -71.0312477630716}, {-63.0918593024578, -51.778150803473}, {-51.521416826996, -40.2077083280113}, {-43.7922679368148, -32.47855943783}, {-38.2581085915768, -26.944400092592}, {-34.0957810191654, -22.7820725201806}, {-30.84797017652, -19.5342616775352}, {-28.2402823256367, -16.926573826652}, {-26.0980989239887, -14.7843904250039}, {-24.3050035624241, -12.9912950634393}, {-22.7803964632344, -11.4666879642496}, {-21.4667027580907, -10.152994259106}, {-20.3216974483539, -9.00798894936896}, {-19.3137084989848, -7.99999999999999}, {-18.418512951979, -7.10480445299431}, {-17.6172676625882, -6.30355916360337}, {-16.8950934812514, -5.58138498226659}, {-16.2400841749642, -4.92637567597948}, {-15.6425985079878, -4.32889000900308}, {-15.0947453854472, -3.78103688646238}, {-14.5900033012399, -3.27629480225512}, {-14.1229349178414, -2.80922641885667}, {-13.6889701407385, -2.37526164175374}, {-13.2842392462769, -1.97053074729215}, {-12.9054430857434, -1.59173458675866}, {-12.5497510962362, -1.23604259725141}, {-12.2147204059341, -0.901011906949392}, {-11.8982311113127, -0.584522612327827}, {-11.5984340741258, -0.284725575140996}, {-11.3137084989848, 6.2803698347351e-16}, {-11.0426272163606, 0.271081282624185}, {-10.7839280840737, 0.529780414911004}, {-10.5364902830162, 0.777218215968515}, {-10.2993145548598, 1.01439394412502}, {-10.0715066353422, 1.24220186364257}, {-9.8522632938097, 1.46144520517507}, {-9.64086051051701, 1.67284798846775}, {-9.43664341682619, 1.87706508215856}, {-9.23901769651784, 2.07469080246694}, {-9.04744220383867, 2.26626629514607}, {-8.86142259929523, 2.45228589968955}, {-8.68050584029662, 2.63320265868815}, {-8.50427539261672, 2.80943310636804}, {-8.33234705185341, 2.98136144713136}, {-8.16436528281636, 3.14934321616846}, {-8.00000000000001, 3.31370849898477}, {-7.83894372471327, 3.47476477427147}, {-7.68090906460313, 3.63279943438164}, {-7.52562646966533, 3.78808202931943}, {-7.37284222572598, 3.94086627325877}, {-7.22231665207911, 4.09139184690565}, {-7.073822474693, 4.23988602429177}, {-6.92714335032841, 4.38656514865635}, {-6.78207252018059, 4.53163597880417}, {-6.63841157438008, 4.67529692460467}, {-6.49596931095132, 4.81773918803342}, {-6.35456067470739, 4.95914782427738}, {-6.21400576311183, 5.09970273587297}, {-6.07412888741154, 5.23957961157323}, {-5.93475767837497, 5.3789508206098}, {-5.79572222678839, 5.51798627219637}, {-5.65685424949238, 5.65685424949238}, {-5.51798627219637, 5.79572222678839}, {-5.37895082060979, 5.93475767837497}, {-5.23957961157323, 6.07412888741155}, {-5.09970273587294, 6.2140057631118}, {-4.95914782427737, 6.35456067470738}, {-4.81773918803342, 6.49596931095133}, {-4.67529692460467, 6.63841157438009}, {-4.53163597880417, 6.7820725201806}, {-4.38656514865635, 6.92714335032841}, {-4.23988602429176, 7.07382247469299}, {-4.09139184690566, 7.22231665207912}, {-3.94086627325877, 7.372842225726}, {-3.78808202931941, 7.52562646966532}, {-3.63279943438163, 7.68090906460313}, {-3.47476477427149, 7.83894372471331}, {-3.31370849898475, 7.99999999999999}, {-3.14934321616844, 8.16436528281632}, {-2.98136144713135, 8.33234705185341}, {-2.80943310636804, 8.50427539261674}, {-2.63320265868815, 8.68050584029661}, {-2.45228589968954, 8.86142259929521}, {-2.26626629514607, 9.04744220383869}, {-2.07469080246693, 9.23901769651784}, {-1.87706508215856, 9.43664341682621}, {-1.67284798846774, 9.64086051051701}, {-1.46144520517506, 9.85226329380968}, {-1.24220186364256, 10.0715066353422}, {-1.01439394412501, 10.2993145548598}, {-0.777218215968502, 10.5364902830162}, {-0.529780414911, 10.7839280840738}, {-0.271081282624175, 11.0426272163606}, {0, 11.3137084989848}, {0.284725575141007, 11.5984340741258}, {0.584522612327831, 11.8982311113126}, {0.901011906949407, 12.2147204059341}, {1.23604259725142, 12.5497510962362}, {1.59173458675867, 12.9054430857434}, {1.97053074729216, 13.2842392462769}, {2.37526164175375, 13.6889701407385}, {2.80922641885668, 14.1229349178414}, {3.27629480225514, 14.5900033012399}, {3.78103688646238, 15.0947453854471}, {4.32889000900309, 15.6425985079878}, {4.9263756759795, 16.2400841749643}, {5.58138498226659, 16.8950934812513}, {6.30355916360339, 17.6172676625882}, {7.10480445299436, 18.4185129519791}, {8.00000000000001, 19.3137084989848}, {9.00798894936894, 20.3216974483537}, {10.152994259106, 21.4667027580907}, {11.4666879642497, 22.7803964632344}, {12.9912950634393, 24.3050035624241}, {14.7843904250039, 26.0980989239886}, {16.926573826652, 28.2402823256367}, {19.5342616775352, 30.84797017652}, {22.7820725201806, 34.0957810191653}, {26.944400092592, 38.2581085915767}, {32.47855943783, 43.7922679368147}, {40.2077083280114, 51.5214168269961}, {51.778150803473, 63.0918593024577}, {71.0312477630715, 82.3449562620563}, {109.491059285321, 120.804767784306}, {224.77784079743, 236.091549296415}};
/**
 * Output data for a test of size 256.
 */
std::complex<double> test_output_8[] = {{2040, 2056}, {-659.865921652369, -643.865921652369}, {-333.883870976666, -317.883870976666}, {-225.201365325598, -209.201365325598}, {-170.843740999898, -154.843740999897}, {-138.216063679483, -122.216063679483}, {-116.45335393882, -100.453353938819}, {-100.899190891482, -84.899190891482}, {-89.2253631008709, -73.2253631008709}, {-80.138418883398, -64.1384188833978}, {-72.8622864294152, -56.8622864294152}, {-66.9031011305941, -50.9031011305939}, {-61.93161924332, -45.9316192433199}, {-57.7199021687123, -41.7199021687122}, {-54.1051360409505, -38.1051360409505}, {-50.9679234800302, -34.9679234800298}, {-48.2187159370068, -32.2187159370068}, {-45.7890346230583, -29.7890346230585}, {-43.6256177953153, -27.6256177953152}, {-41.6864162680224, -25.6864162680224}, {-39.9377902701606, -23.9377902701607}, {-38.3525072007064, -22.3525072007064}, {-36.9082854504595, -20.9082854504594}, {-35.5867180962642, -19.5867180962642}, {-34.3724656715066, -18.3724656715066}, {-33.2526426715263, -17.2526426715263}, {-32.2163456345422, -16.2163456345422}, {-31.2542860933243, -15.2542860933243}, {-30.3585021799238, -14.3585021799238}, {-29.5221298982369, -13.5221298982369}, {-28.7392201419047, -12.7392201419046}, {-28.0045911279541, -12.0045911279541}, {-27.3137084989848, -11.3137084989848}, {-26.6625872248108, -10.6625872248108}, {-26.0477108154332, -10.0477108154333}, {-25.4659643830732, -9.46596438307318}, {-24.9145788603891, -8.9145788603891}, {-24.391084264246, -8.39108426424598}, {-23.8932703387469, -7.89327033874693}, {-23.4191532530405, -7.41915325304053}, {-22.9669472943151, -6.96694729431511}, {-22.5350407031392, -6.5350407031392}, {-22.1219749607535, -6.12197496075354}, {-21.7264269663653, -5.72642696636529}, {-21.3471936446681, -5.34719364466804}, {-20.9831786055476, -4.98317860554761}, {-20.6333805436817, -4.63338054368167}, {-20.2968831188952, -4.29688311889501}, {-19.9728461013239, -3.97284610132391}, {-19.6604976006968, -3.66049760069689}, {-19.3591272279527, -3.35912722795272}, {-19.068080061223, -3.06808006122299}, {-18.7867513078937, -2.78675130789375}, {-18.5145815708086, -2.51458157080865}, {-18.2510526402925, -2.25105264029243}, {-17.9956837450686, -1.99568374506863}, {-17.7480282047038, -1.74802820470381}, {-17.5076704342637, -1.50767043426373}, {-17.2742232586674, -1.27422325866748}, {-17.0473254999906, -1.04732549999061}, {-16.8266398058679, -0.826639805867764}, {-16.6118506913221, -0.611850691322129}, {-16.4026627699189, -0.402662769918877}, {-16.1987991532018, -0.198799153201675}, {-16, 8.88178419700125e-16}, {-15.806021199459, 0.193978800540851}, {-15.6166331736074, 0.383366826392617}, {-15.431619786963, 0.568380213037072}, {-15.2507773521532, 0.749222647846787}, {-15.0739137218028, 0.926086278197202}, {-14.9008474580539, 1.0991525419461}, {-14.731407072058, 1.26859292794198}, {-14.5654303266293, 1.43456967337074}, {-14.4027635959946, 1.59723640400544}, {-14.2432612772315, 1.75673872276846}, {-14.086785248562, 1.91321475143801}, {-13.9332043701763, 2.06679562982372}, {-13.7823940237136, 2.21760597628636}, {-13.6342356869204, 2.36576431307964}, {-13.488616540359, 2.51138345964114}, {-13.3454291033544, 2.65457089664561}, {-13.2045708966412, 2.79542910335873}, {-13.0659441294206, 2.93405587057946}, {-12.9294554087589, 3.07054459124107}, {-12.7950154694554, 3.2049845305446}, {-12.6625389226798, 3.33746107732018}, {-12.5319440218428, 3.46805597815726}, {-12.4031524442981, 3.59684755570189}, {-12.2760890876063, 3.72391091239368}, {-12.1506818791998, 3.84931812080021}, {-12.0268615983943, 3.97313840160566}, {-11.9045617097829, 4.09543829021711}, {-11.7837182071306, 4.21628179286944}, {-11.6642694669654, 4.33573053303461}, {-11.5461561111269, 4.45384388887314}, {-11.429320877596, 4.570679122404}, {-11.3137084989848, 4.68629150101525}, {-11.1992655881163, 4.80073441188371}, {-11.085940530169, 4.914059469831}, {-10.9736833809019, 5.02631661909806}, {-10.8624457705162, 5.13755422948382}, {-10.7521808127394, 5.2478191872606}, {-10.6428430187547, 5.35715698124533}, {-10.5343882156208, 5.46561178437916}, {-10.4267734688587, 5.57322653114126}, {-10.3199570089008, 5.68004299109916}, {-10.2138981611233, 5.78610183887668}, {-10.1085572791993, 5.89144272080068}, {-10.0038956815305, 5.99610431846957}, {-9.89987559052855, 6.10012440947145}, {-9.79646007453704, 6.20353992546297}, {-9.69361299219189, 6.30638700780818}, {-9.59129893903727, 6.40870106096274}, {-9.48948319622067, 6.5105168037793}, {-9.38813168110284, 6.61186831889715}, {-9.28721089962791, 6.71278910037207}, {-9.18668790030676, 6.81331209969321}, {-9.08653022967508, 6.91346977032488}, {-8.98670588909392, 7.0132941109061}, {-8.8871832927673, 7.11281670723272}, {-8.78793122685733, 7.21206877314274}, {-8.688918809581, 7.31108119041899}, {-8.5901154521796, 7.40988454782041}, {-8.49149082065274, 7.50850917934726}, {-8.39301479815575, 7.60698520184427}, {-8.29465744795877, 7.70534255204127}, {-8.19638897687133, 7.80361102312867}, {-8.09817969903645, 7.90182030096355}, {-8, 8}, {-7.90182030096349, 8.09817969903645}, {-7.80361102312867, 8.19638897687133}, {-7.70534255204127, 8.29465744795874}, {-7.60698520184425, 8.39301479815575}, {-7.50850917934724, 8.49149082065272}, {-7.40988454782042, 8.59011545217962}, {-7.31108119041898, 8.688918809581}, {-7.2120687731427, 8.78793122685729}, {-7.11281670723267, 8.88718329276734}, {-7.01329411090609, 8.9867058890939}, {-6.91346977032488, 9.08653022967511}, {-6.81331209969321, 9.18668790030678}, {-6.71278910037207, 9.28721089962793}, {-6.61186831889714, 9.38813168110285}, {-6.51051680377933, 9.48948319622073}, {-6.40870106096273, 9.59129893903728}, {-6.30638700780814, 9.69361299219185}, {-6.20353992546296, 9.79646007453704}, {-6.10012440947146, 9.89987559052857}, {-5.99610431846955, 10.0038956815304}, {-5.89144272080067, 10.1085572791993}, {-5.78610183887668, 10.2138981611233}, {-5.68004299109915, 10.3199570089009}, {-5.57322653114127, 10.4267734688587}, {-5.46561178437915, 10.5343882156208}, {-5.35715698124531, 10.6428430187547}, {-5.2478191872606, 10.7521808127394}, {-5.13755422948381, 10.8624457705162}, {-5.02631661909804, 10.9736833809019}, {-4.91405946983102, 11.085940530169}, {-4.8007344118837, 11.1992655881163}, {-4.68629150101523, 11.3137084989848}, {-4.57067912240399, 11.429320877596}, {-4.45384388887311, 11.5461561111269}, {-4.3357305330346, 11.6642694669654}, {-4.21628179286943, 11.7837182071306}, {-4.09543829021709, 11.9045617097829}, {-3.97313840160565, 12.0268615983944}, {-3.8493181208002, 12.1506818791998}, {-3.72391091239367, 12.2760890876063}, {-3.59684755570188, 12.4031524442981}, {-3.46805597815725, 12.5319440218427}, {-3.33746107732018, 12.6625389226798}, {-3.2049845305446, 12.7950154694554}, {-3.07054459124105, 12.9294554087589}, {-2.93405587057945, 13.0659441294206}, {-2.79542910335874, 13.2045708966413}, {-2.6545708966456, 13.3454291033544}, {-2.51138345964113, 13.4886165403589}, {-2.36576431307963, 13.6342356869204}, {-2.21760597628634, 13.7823940237136}, {-2.06679562982371, 13.9332043701763}, {-1.913214751438, 14.086785248562}, {-1.75673872276845, 14.2432612772316}, {-1.59723640400543, 14.4027635959946}, {-1.43456967337073, 14.5654303266293}, {-1.26859292794196, 14.731407072058}, {-1.09915254194608, 14.9008474580539}, {-0.926086278197197, 15.0739137218028}, {-0.749222647846782, 15.2507773521532}, {-0.568380213037063, 15.431619786963}, {-0.383366826392603, 15.6166331736074}, {-0.193978800540849, 15.806021199459}, {0, 16}, {0.198799153201676, 16.1987991532018}, {0.402662769918892, 16.4026627699189}, {0.611850691322136, 16.6118506913222}, {0.826639805867769, 16.8266398058678}, {1.04732549999062, 17.0473254999906}, {1.2742232586675, 17.2742232586675}, {1.50767043426374, 17.5076704342637}, {1.74802820470383, 17.7480282047038}, {1.99568374506864, 17.9956837450686}, {2.25105264029244, 18.2510526402924}, {2.51458157080866, 18.5145815708087}, {2.78675130789376, 18.7867513078938}, {3.068080061223, 19.068080061223}, {3.35912722795274, 19.3591272279527}, {3.6604976006969, 19.6604976006969}, {3.97284610132392, 19.9728461013239}, {4.296883118895, 20.296883118895}, {4.63338054368169, 20.6333805436817}, {4.98317860554763, 20.9831786055477}, {5.34719364466804, 21.347193644668}, {5.72642696636529, 21.7264269663653}, {6.12197496075356, 22.1219749607535}, {6.53504070313922, 22.5350407031392}, {6.96694729431513, 22.9669472943151}, {7.41915325304055, 23.4191532530405}, {7.89327033874693, 23.8932703387469}, {8.39108426424602, 24.391084264246}, {8.91457886038912, 24.9145788603891}, {9.46596438307321, 25.4659643830732}, {10.0477108154334, 26.0477108154333}, {10.6625872248108, 26.6625872248108}, {11.3137084989848, 27.3137084989848}, {12.0045911279541, 28.004591127954}, {12.7392201419045, 28.7392201419046}, {13.5221298982369, 29.5221298982369}, {14.3585021799238, 30.3585021799238}, {15.2542860933243, 31.2542860933243}, {16.2163456345422, 32.2163456345422}, {17.2526426715263, 33.2526426715263}, {18.3724656715066, 34.3724656715065}, {19.5867180962642, 35.5867180962642}, {20.9082854504594, 36.9082854504594}, {22.3525072007065, 38.3525072007064}, {23.9377902701607, 39.9377902701607}, {25.6864162680224, 41.6864162680223}, {27.6256177953153, 43.6256177953153}, {29.7890346230587, 45.7890346230585}, {32.2187159370068, 48.2187159370068}, {34.9679234800297, 50.9679234800299}, {38.1051360409505, 54.1051360409505}, {41.7199021687123, 57.7199021687123}, {45.9316192433199, 61.9316192433199}, {50.9031011305939, 66.9031011305939}, {56.8622864294154, 72.8622864294153}, {64.1384188833978, 80.1384188833979}, {73.2253631008709, 89.2253631008708}, {84.899190891482, 100.899190891482}, {100.453353938819, 116.453353938819}, {122.216063679483, 138.216063679483}, {154.843740999898, 170.843740999897}, {209.201365325597, 225.201365325597}, {317.883870976667, 333.883870976666}, {643.86592165237, 659.865921652368}};

/**
 * Execute an FFT for the input array and compare it to the output array.
 * Also displays whether the test is passed, index when comparison failed and elapsed time.
 * @param testName Test case name to display.
 * @param input Input for thr FFT. As computation is done in place, this will be turned into output.
 * @param output Expected output to compare.
 * @param length Length of the input and output arrays.
 */
void test(const std::string& testName, std::complex<double>* input, const std::complex<double>* output, int length) {
    // Execute FFT and measure elapsed time.
    auto start = std::chrono::steady_clock::now();
    fft(input, length);
    auto finish = std::chrono::steady_clock::now();
    // Compare arrays.
    for (int i = 0; i < length; i++) {
        // Here we need to lower down the epsilon value to compare doubles
        // because abs() for complex numbers calculates sqrt(re*re + im*im) which is less precise than abs() for real numbers.
        if (std::abs(input[i] - output[i]) > 1e-12) {
            std::cout << testName << ": FAILED at index " << i << ": " << std::setprecision(15) << input[i] << " != " << output[i] << std::endl;
            return;
        }
    }
    std::cout << testName << ": PASSED (" << std::chrono::duration_cast<std::chrono::nanoseconds> (finish - start).count() << " nanoseconds)" << std::endl;
}

/**
 * Main function.
 * @return Exit code.
 */
int main()
{
    std::cout << "=== FAST FOURIER TRANSFORMATION ===" << std::endl;
    test("Test 1", test_input_1, test_output_1, 2);
    test("Test 2", test_input_2, test_output_2, 4);
    test("Test 3", test_input_3, test_output_3, 8);
    test("Test 4", test_input_4, test_output_4, 16);
    test("Test 5", test_input_5, test_output_5, 32);
    test("Test 6", test_input_6, test_output_6, 64);
    test("Test 7", test_input_7, test_output_7, 128);
    test("Test 8", test_input_8, test_output_8, 256);
    std::cout << "===================================" << std::endl;
    return 0;
}
